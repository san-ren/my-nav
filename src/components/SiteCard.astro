---
import { Image } from 'astro:assets';
const { title, url, desc } = Astro.props;

// 自动 Logo API 策略：优先用 Google，失败回退到默认
// 你也可以换成 https://api.iowen.cn/favicon/ (WebStack同款)
const getFavicon = (u) => {
  try {
    const domain = new URL(u).hostname;
    return `https://www.google.com/s2/favicons?domain=${domain}&sz=128`;
  } catch (e) {
    return '/favicon.svg';
  }
};

const logoUrl = getFavicon(url);
---

<a href={url} target="_blank" class="group relative flex items-center p-3 bg-white dark:bg-gray-800 rounded-xl border border-gray-100 dark:border-gray-700 hover:shadow-[0_8px_20px_rgba(0,0,0,0.08)] hover:-translate-y-1 transition-all duration-300">
  <div class="flex-shrink-0 mr-3 w-10 h-10 rounded-full bg-gray-50 dark:bg-gray-700 overflow-hidden flex items-center justify-center border border-gray-100 dark:border-gray-600">
    <!-- 图片加载失败时会自动隐藏，这里可以加一段简单的 JS 处理 onerror，或者直接利用 object-cover -->
    <img 
      src={logoUrl} 
      alt={title} 
      loading="lazy"
      class="w-full h-full object-cover" 
      onerror="this.src='/favicon.svg'" 
    />
  </div>
  <div class="overflow-hidden flex-1">
    <h3 class="font-bold text-sm text-gray-800 dark:text-gray-100 truncate group-hover:text-blue-500 transition-colors">
      {title}
    </h3>
    <p class="text-xs text-gray-400 dark:text-gray-500 truncate mt-0.5">
      {desc || url}
    </p>
  </div>
</a>